
# 課題

マルチテナントについて
課題２−１

# 結論

## 2-1

- １DBに１つのテナント（サイロモデル）
  - メリット
    - 各テナントのデータが完全に隔離され、他のテナントの影響を受けない
    - パフォーマンス分離がしやすい
    - テナントごとのカスタマイズが可能
  - デメリット
    - 運用コストが高い
    - スケーラビリティが問題になる
    - 開発・運用コストも高い
- １スキーマに１テナント
  - メリット
    - サイロモデルより新規テナント作成が容易
    - サイロモデルよりコスト削減
  - デメリット
    - 他スキーマの影響（ノイジーネイバー）によるパフォーマンス悪化がある
    - テナント数に比例してテーブル数も増加
- すべてのテナントで同じスキーマを使う
  - メリット
    - 大量のテナントを1つのDBで管理でき、運用・開発がシンプル＆スケーラビリティが高い
    - DBリソースを最大限共有でき、コスト効率が高い
  - デメリット
    - セキュリティリスクが高い
    - ノイジーネイバーによるパフォーマンス悪化がある

参考資料: <https://www.slideshare.net/AmazonWebServicesJapan/20220107-multi-tenant-database#7>

## 2-2

概要として以下の形で行う。

1. RLSの有効化
2. ポリシー（POLICY）の作成
3. ポリシーの有効化
4. テナント情報を操作側（アプリ側）は渡して操作

公式資料: <https://www.postgresql.org/docs/current/ddl-rowsecurity.html>
